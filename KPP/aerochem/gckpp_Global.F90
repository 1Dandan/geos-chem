! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Global Data Module File
! 
! Generated by KPP-2.3.2_gc symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : gckpp_Global.F90
! Equation file        : gckpp.kpp
! Output root filename : gckpp
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



MODULE gckpp_Global

  USE gckpp_Parameters, ONLY: dp, NSPEC, NVAR, NFIX, NREACT
  PUBLIC
  SAVE


! Declaration of global variables

! These quantities vary with lon/lat/lev location.
! They must be declared THREADPRIVATE for the parallel
! loop over all cells in the chemistry grid.

! C - Concentration of all species
  REAL(kind=dp) :: C(NSPEC)
  !$OMP THREADPRIVATE( C )
! VAR - Concentrations of variable species (global)
  REAL(kind=dp) :: VAR(NVAR)
  !$OMP THREADPRIVATE( VAR )
! FIX - Concentrations of fixed species (global)
  REAL(kind=dp) :: FIX(NFIX)
  !$OMP THREADPRIVATE( FIX )
! RCONST - Rate constants (global)
  REAL(kind=dp) :: RCONST(NREACT)
  !$OMP THREADPRIVATE( RCONST )
! TIME - Current integration time
  REAL(kind=dp) :: TIME
  !$OMP THREADPRIVATE( TIME )
! TEMP - Temperature
  REAL(kind=dp) :: TEMP
  !$OMP THREADPRIVATE( TEMP )
! SR_TEMP - Square root of Temperature [K**0.5]
  REAL(kind=dp) :: SR_TEMP
  !$OMP THREADPRIVATE( SR_TEMP )
! TEMP_OVER_K300 - Temperature [K] / 300.0
  REAL(kind=dp) :: TEMP_OVER_K300
  !$OMP THREADPRIVATE( TEMP_OVER_K300 )
! K300_OVER_TEMP - 300.0 / Temperature [K]
  REAL(kind=dp) :: K300_OVER_TEMP
  !$OMP THREADPRIVATE( K300_OVER_TEMP )
! CFACTOR - Conversion factor for concentration units
  REAL(kind=dp) :: CFACTOR
  !$OMP THREADPRIVATE( CFACTOR )
! NUMDEN - Air number density [#/cm3]
  REAL(kind=dp) :: NUMDEN
  !$OMP THREADPRIVATE( NUMDEN )

! These variables do not vary with location, and can be
! assigned outside of the parallel loop over cells in the
! chemistry grid.  These do not need to be THREADPRIVATE.

! MW - Species molecular weight [g/mole]
  REAL(kind=dp) :: MW(NSPEC)
! SR_MW - Square root of species molecular weight [g/mole]
  REAL(kind=dp) :: SR_MW(NSPEC)
! RTOLS - (scalar) Relative tolerance
  REAL(kind=dp) :: RTOLS
! TSTART - Integration start time
  REAL(kind=dp) :: TSTART
! TEND - Integration end time
  REAL(kind=dp) :: TEND
! DT - Integration step
  REAL(kind=dp) :: DT
! ATOL - Absolute tolerance
  REAL(kind=dp) :: ATOL(NVAR)
! RTOL - Relative tolerance
  REAL(kind=dp) :: RTOL(NVAR)
! STEPMIN - Lower bound for integration step
  REAL(kind=dp) :: STEPMIN
! STEPMAX - Upper bound for integration step
  REAL(kind=dp) :: STEPMAX

! INLINED global variable declarations

  !-----------------------------------------------------------------------
  ! Add parameters to isolate a box for debugging
  !-----------------------------------------------------------------------
  INTEGER,  PARAMETER :: I_dbg = 50
  INTEGER,  PARAMETER :: J_dbg = 2
  INTEGER,  PARAMETER :: L_dbg = 44

  !-----------------------------------------------------------------------
  ! Add more inlined global parameters for heterogeneous chemistry here
  !-----------------------------------------------------------------------

  ! Minimum heterogeneous chemistry lifetime and reaction rate
  REAL(dp), PARAMETER :: HetMinLife  = 1.e-3_dp
  REAL(dp), PARAMETER :: HetMinRate  = 1.0_dp / HetMinLife

  ! Critical RH for uptake of GLYX, MGLYX, and GLYC:
  REAL(dp), PARAMETER :: CRITRH      = 35.0e+0_dp

  ! Effective Henry's Law constant of IEPOX for reactive uptake to aqueous
  ! aerosols (M/atm).  Eloise Marais (2015/07) reset this to the value from
  ! [Nguyen et al., 2014] in order to accomodate reduction in yields of RIP
  ! (which is the precursor of IEPOX).
  REAL(dp), PARAMETER :: HSTAR_EPOX  = 1.7e+7_dp

  ! Conversion factor from atm to bar
  REAL(dp), PARAMETER :: con_atm_bar = 1.0_dp / 1.01325_dp

  ! Universal gas consatant [bar/(mol/kg)/K]  (Source: NIST, 2014)
  ! NOTE: Make sure this is consistent w/ the value in physconsts.F90!
  REAL(dp), PARAMETER :: con_R       = 0.083144598_dp

  ! Reference temperature
  REAL(dp), PARAMETER :: INV_T298    = 1.0_dp / 298.15_dp

  !--------------------------------------------------------------------------
  ! Add more global variables here, so that they can be used
  ! in inlined functions that will get written to gckpp_Rates.F90
  !--------------------------------------------------------------------------

  ! H2O concentration
  REAL(dp) :: H2O
  !$OMP THREADPRIVATE( H2O )

  ! Henry's law constants (do not need to be THREADPRIVATE)
  REAL(dp) :: HENRY_K0(NSPEC)
  REAL(dp) :: HENRY_CR(NSPEC)

  ! Array for heterogeneous rates
  !
  ! NOTES:
  ! (a) AERI            = Iodine (I-) on aerosol
  ! (b) BrSALA (BrSALC) = Fine (coarse) sea salt bromine (Br-)
  ! (c) SALACL (SALCCL) = Fine (coarse) sea salt chlorine (Cl-)
  ! (d) ISALA  (ISALC ) = Fine (coarse) sea salt iodine (I-)
  !
  ! HET(ind_BrNO3,  1) : BrNO3  +  H2O          # hydrolysis rxn
  ! HET(ind_BrNO3,  2) : BrNO3  +  HCl
  ! HET(ind_ClNO2,  1) : ClNO2  +  SALACL
  ! HET(ind_ClNO2,  2) : ClNO2  +  SALCCL
  ! HET(ind_ClNO2,  3) : ClNO3  +  HCl          # in-cloud only
  ! HET(ind_ClNO2,  4) : ClNO2  +  BrSALA
  ! HET(ind_ClNO2,  5) : ClNO2  +  BrSALC
  ! HET(ind_ClNO2,  6) : ClNO2  +  HBr          # in-cloud only
  ! HET(ind_ClNO3,  1) : ClNO3  +  H2O          # hydrolysis rxn
  ! HET(ind_ClNO3,  2) : ClNO3  +  HCl
  ! HET(ind_ClNO3,  3) : ClNO3  +  HBr
  ! HET(ind_ClNO3,  4) : ClNO3  +  BrSALA
  ! HET(ind_ClNO3,  5) : ClNO3  +  BrSALC
  ! HET(ind_ClNO3,  6) : ClNO3  +  SALACL
  ! HET(ind_ClNO3,  7) : CLNO3  +  SALCCL
  ! HET(ind_GLYX,   1) : GLYX   uptake          # 1st-order loss rxn
  ! HET(ind_HBr,    1) : Br     -> BrSALA
  ! HET(ind_HBr,    2) : Br     -> BrSALC
  ! HET(ind_HI,     1) : HI     -> AERI         # uptake by SO4
  ! HET(ind_HI,     2) : HI     -> ISALA        # uptake by SALA
  ! HET(ind_HI,     3) : HI     -> ISALC        # uptake by SALC
  ! HET(ind_HMML,   1) : HMML   uptake          # 1st-order loss rxn
  ! HET(ind_HO2,    1) : HO2    uptake          # 1st-order loss rxn
  ! HET(ind_HOBr,   1) : HOBr   +  HBr
  ! HET(ind_HOBr,   2) : HOBr   +  HCl
  ! HET(ind_HOBr,   3) : HOBr   +  SALACL
  ! HET(ind_HOBr,   4) : HOBr   +  SALCCL
  ! HET(ind_HOBr,   5) : HOBr   +  BrSALA
  ! HET(ind_HOBr,   6) : HOBr   +  BrSALC
  ! HET(ind_HOBr,   7) : HOBr   +  HSO3-(aq)
  ! HET(ind_HOBr,   8) : HOBr   +  HSO3--(aq)
  ! HET(ind_HOCl,   1) : HOCl   +  HCl
  ! HET(ind_HOCl,   2) : HOCl   +  HBr
  ! HET(ind_HOCl,   3) : HOCl   +  SALACL
  ! HET(ind_HOCl,   4) : HOCl   +  SALCCL
  ! HET(ind_HOCl,   5) : HOCl   +  HSO3--(aq)
  ! HET(ind_HOCl,   6) : HOCl   +  SO3--(aq)
  ! HET(ind_HOI,    1) : HOI    -> ISALA        # uptake by alkaline SALA
  ! HET(ind_HOI,    2) : HOI    -> ISALC        # uptake by alkaline SALC
  ! HET(ind_HOI,    3) : HOI    +  BrSALA       # breakdown by BrSALA
  ! HET(ind_HOI,    4) : HOI    +  BrSALC       # breakdown by BrSALC
  ! HET(ind_HOI,    5) : HOI    +  SALACL       # breakdown by SALACL
  ! HET(ind_HOI,    6) : HOI    +  SALCCL       # breakdown by SALCCL
  ! HET(ind_HONIT,  1) : HONIT  uptake          # 1st order loss rxn
  ! HET(ind_I2O2,   1) : I2O2   -> AERI         # uptake by SO4
  ! HET(ind_I2O2,   2) : I2O2   -> ISALA        # uptake by SALA
  ! HET(ind_I2O2,   3) : I2O2   -> ISALC        # uptake by SALC
  ! HET(ind_I2O3,   1) : I2O3   -> AERI         # uptake by SO4
  ! HET(ind_I2O3,   2) : I2O3   -> ISALA        # uptake by SALA
  ! HET(ind_I2O3,   3) : I2O3   -> ISALC        # uptake by SALC
  ! HET(ind_I2O4,   1) : I2O4   -> AERI         # uptake by SO4
  ! HET(ind_I2O4,   2) : I2O4   -> ISALA        # uptake by SALA
  ! HET(ind_I2O4,   3) : I2O4   -> ISALC        # uptake by SALC
  ! HET(ind_ICHE,   1) : ICHE   uptake          # 1st order loss rxn
  ! HET(ind_IDN,    1) : IDN    uptake          # 1st order loss rxn
  ! HET(ind_IEPOXA, 1) : IEPOXA uptake          # 1st order loss rxn
  ! HET(ind_IEPOXB, 1) : IEPOXB uptake          # 1st order loss rxn
  ! HET(ind_IEPOXD, 1) : IEPOXD uptake          # 1st order loss rxn
  ! HET(ind_IHN1,   1) : IHN1   uptake          # 1st order loss rxn
  ! HET(ind_IHN2,   1) : IHN2   uptake          # 1st order loss rxn
  ! HET(ind_IHN3,   1) : IHN3   uptake          # 1st order loss rxn
  ! HET(ind_IHN4,   1) : IHN4   uptake          # 1st order loss rxn
  ! HET(ind_INPB,   1) : INPB   uptake          # 1st order loss rxn
  ! HET(ind_INPD,   1) : INPD   uptake          # 1st order loss rxn
  ! HET(ind_IONITA, 1) : IONITA uptake          # 1st order loss rxn
  ! HET(ind_IONO,   1) : IONO   -> ISALA        # uptake by alkaline SALA
  ! HET(ind_IONO,   2) : IONO   -> ISALC        # uptake by alkaline SALC
  ! HET(ind_IONO,   3) : IONO   +  BrSALA       # breakdown by BrSALA
  ! HET(ind_IONO,   4) : IONO   +  BrSALC       # breakdown by BrSALC
  ! HET(ind_IONO,   5) : IONO   +  SALACL       # breakdown by SALACL
  ! HET(ind_IONO,   6) : IONO   +  SALCCL       # breakdown by SALCCL
  ! HET(ind_IONO2,  1) : IONO2  -> ISALA        # uptake by alkaline SALA
  ! HET(ind_IONO2,  2) : IONO2  -> ISALC        # uptake by alkaline SALC
  ! HET(ind_IONO2,  3) : IONO2  +  BrSALA       # breakdown by BrSALA
  ! HET(ind_IONO2,  4) : IONO2  +  BrSALC       # breakdown by BrSALC
  ! HET(ind_IONO2,  5) : IONO2  +  SALACL       # breakdown by SALACL
  ! HET(ind_IONO2,  6) : IONO2  +  SALCCL       # breakdown by SALCCL
  ! HET(ind_ITCN,   1) : ITCN   uptake          # 1st order loss rxn
  ! HET(ind_ITHN,   1) : ITHN   uptake          # 1st order loss rxn
  ! HET(ind_LVOC,   1) : LVOC   uptake          # 1st order loss rxn
  ! HET(ind_MCRHN,  1) : MCRHN  uptake          # 1st order loss rxn
  ! HET(ind_MCRHNB, 1) : MCRHNB uptake          # 1st order loss rxn
  ! HET(ind_MGLY,   1) : MGLY   uptake          # 1st order loss rxn
  ! HET(ind_MONITA, 1) : MONITA uptake          # 1st order loss rxn
  ! HET(ind_MONITS, 1) : MONITS uptake          # 1st order loss rxn
  ! HET(ind_MONITU, 1) : MONITU uptake          # 1st order loss rxn
  ! HET(ind_NO2,    1) : NO2    uptake          # 1st order loss rxn + cloud
  ! HET(ind_NO3,    1) : NO3    uptake          # 1st order loss rxn + cloud
  ! HET(ind_NO3,    2) : NO3    uptake on N2O5  # Liquid water cloud
  ! HET(ind_NO3,    3) : Cl-                    # Enhanced NO3 hydrolysis
  ! HET(ind_N2O5,   1) : N2O5  + H2O            # Where educt is consumed
  ! HET(ind_N2O5,   2) : N2O5  + HCl
  ! HET(ind_N2O5,   3) : N2O5  + H2O            # On liquid cloud water
  ! HET(ind_N2O5,   4) : N2O5  + SALACL
  ! HET(ind_N2O5,   5) : N2O5  + SALCCL
  ! HET(ind_O3,     1) : O3    + HBr
  ! HET(ind_O3,     2) : O3    + BrSALA
  ! HET(ind_O3,     3) : O3    + BrSALC
  ! HET(ind_OH,     1) : OH    + SALACL
  ! HET(ind_OH,     2) : OH    + SALCCL
  ! HET(ind_PYAC,   1) : PYAC  uptake           # 1st order loss rxn
  ! HET(ind_R4N2,   1) : R4N2  uptake           # 1st order loss rxn
  REAL(kind=dp) :: HET(NSPEC,8)
  !$OMP THREADPRIVATE( HET )

  ! Array for photolysis rates
  REAL(dp) :: PHOTOL(1000)
  !$OMP THREADPRIVATE( PHOTOL )

  ! Pressure and relative humidity
  REAL(dp) :: PRESS
  REAL(dp) :: RELHUM
  !$OMP THREADPRIVATE( PRESS, RELHUM )

  ! Cosine of solar zenith angle
  REAL(dp) :: SUNCOS
  !$OMP THREADPRIVATE( SUNCOS )

  TYPE, PUBLIC :: HetState
     LOGICAL  :: natSurface     ! Is there NAT in this box?
     LOGICAL  :: pscBox         ! Does this box have Polar Strat Clouds?
     LOGICAL  :: stratBox       ! Is this box in the stratosphere?
     INTEGER  :: NAEROTYPE      ! Number of aerosol types
     LOGICAL  :: is_UCX         ! Are we using the UCX mechanism?
     REAL(dp) :: aClArea        ! Fine SSA+SNA aerosol area [cm2/cm3]
     REAL(dp) :: aClRadi        ! Fine SSA+SNA aerosol radius [cm]
     REAL(dp) :: aClVol         ! Fine SSA+SNA aerosol volume [cm3/cm3]
     REAL(dp) :: aIce           ! Ice surface area
     REAL(dp) :: aLiq           ! Liquid surface area
     REAL(dp) :: aWater(2)      ! ISORROPIA aerosol water (fine & coarse)
     REAL(dp) :: BrConc_CldA    ! Br- in cloud (fine sea salt)   [mol/kg water]
     REAL(dp) :: BrConc_CldC    ! Br- in cloud (coarse sea salt) [mol/kg water]
     REAL(dp) :: BrConc_CldG    ! Br- in cloud (gas-phase)       [mol/kg water]
     REAL(dp) :: BrConc_SALA    ! Br- in fine sea salt aerosol   [mol/kg water]
     REAL(dp) :: BrConc_SALC    ! Br- in coarse sea salt aerosol [mol/kg water]
     REAL(dp) :: ClConc_CldA    ! Br- in cloud (fine sea salt)   [mol/kg water]
     REAL(dp) :: ClConc_CldC    ! Br- in cloud (coarse sea salt) [mol/kg water]
     REAL(dp) :: ClConc_CldG    ! Cl- in cloud (gas-phase)       [mol/kg water]
     REAL(dp) :: ClConc_SALA    ! Cl- in fine sea salt           [mol/kg water]
     REAL(dp) :: ClConc_SALC    ! Cl- in coarse sea salt         [mol/kg water]
     REAL(dp) :: cldFr          ! Cloud fraction [1]
     REAL(dp) :: clearFr        ! Clear sky fraction [1]
     REAL(dp) :: fupdateHOBr    !
     REAL(dp) :: fupdateHOCl    !
     REAL(dp) :: gamma_HO2      ! Uptake reaction probability for HO2 [1]
     REAL(dp) :: H2O            ! H2O concentration
     REAL(dp) :: HBr_th         ! HBr theta
     REAL(dp) :: HCl_th         ! HCl theta
     REAL(dp) :: hConc_ICl      ! Liquid phase pH, Cl-
     REAL(dp) :: hConc_LCl      ! Liquid phase pH, Cl-
     REAL(dp) :: hConc_SSA      ! Liquid phase pH, fine sea salt
     REAL(dp) :: hConc_SSC      ! Liquid phase pH, coarse sea salt
     REAL(dp) :: hConc_Sul      ! Liquid phase pH, sulfate
     REAL(dp) :: HetTemp(3)     !
     REAL(dp) :: HNO3_th        ! HNO3 theta
     REAL(dp) :: HSO3conc_Cld   !
     REAL(dp) :: H_plus         ! Proton activity [1] and H+ concentration [M]
     REAL(dp) :: KHETI_SLA(11)  ! Uptake probabilities for PSC reactions on SLA
     REAL(dp) :: mHSO4          ! Bisulfate concentration [M]
     REAL(dp) :: mNO3           ! Nitrate concentration [M]
     REAL(dp) :: mSO4           ! Sulfate concentration [M]
     REAL(dp) :: NitConc_SALA   ! Cl- in fine sea salt           [mol/kg water]
     REAL(dp) :: NitConc_SALC   ! Cl- in coarse sea salt         [mol/kg water]
     REAL(dp) :: PI             ! PI constant
     REAL(dp) :: pHCloud        !
     REAL(dp) :: pHSSA(2)       !
     REAL(dp) :: OMOC_POA       ! Organic matter/organic carbon in POA
     REAL(dp) :: OMOC_OPOA      ! Organic matter/organic carbon in POA
     REAL(dp) :: qIce           ! Ice mixing ratio [kg/kg]
     REAL(dp) :: qLIq           ! Water mixing ratio [kg/kg]
     REAL(dp) :: rIce           ! Ice radius
     REAL(dp) :: rLiq           ! Liquid radius
     REAL(dp) :: RGASLATM       ! Gas constant [L*atm/K/mole]
     REAL(dp) :: RSTARG         ! Gas constant [J/K/mole]
     REAL(dp) :: SPC_SALA       ! SALA concentration
     REAL(dp) :: SO3conc_Cld    !
     REAL(dp) :: ssAlk(2)       ! Sea salt alkalinity (fine, coarse)
     LOGICAL  :: ssFineIsAlk    ! Is fine sea-salt alkaline?
     LOGICAL  :: ssFineIsAcid   ! Is fine sea-salt alkaline?
     LOGICAL  :: ssCoarseIsAlk  ! Is coarse sea-salt alkaline?
     LOGICAL  :: ssCoarseIsAcid ! Is coarse sea-salt acid?
     REAL(dp) :: vAir           ! Volume of air [cm3]
     REAL(dp) :: vIce           ! Ice volume [cm3]
     REAL(dp) :: vLiq           ! Liquid volume [cm3]
     REAL(dp) :: xArea(14)      ! Aerosol specific sfc area [cm3 H2O/cm3 air]
     REAL(dp) :: xH2O(14)       ! Aerosol water content [cm3 H2O/cm3 air]
     REAL(dp) :: xRadi(14)      ! Aerosol effective radius (cm)
     REAL(dp) :: xVol(14)       ! Aerosol specific volume [cm3/cm3 air]
  END TYPE HetState
  TYPE(HetState), TARGET, PUBLIC :: State_Het
  !$OMP THREADPRIVATE( State_Het )

! INLINED global variable declarations


END MODULE gckpp_Global

