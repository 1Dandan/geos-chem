! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! The Reaction Rates File
! 
! Generated by KPP-2.2 symbolic chemistry Kinetics PreProcessor
!       (http://www.cs.vt.edu/~asandu/Software/KPP)
! KPP is distributed under GPL, the general public licence
!       (http://www.gnu.org/copyleft/gpl.html)
! (C) 1995-1997, V. Damian & A. Sandu, CGRER, Univ. Iowa
! (C) 1997-2005, A. Sandu, Michigan Tech, Virginia Tech
!     With important contributions from:
!        M. Damian, Villanova University, USA
!        R. Sander, Max-Planck Institute for Chemistry, Mainz, Germany
! 
! File                 : gckpp_Rates.f90
! Time                 : Fri May 29 16:36:46 2009
! Working directory    : /home/phs/KPP/v8-02-01_43t
! Equation file        : gckpp.kpp
! Output root filename : gckpp
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!   16 Sep 2009 - P. Le Sager - Replaced COMODE_MOD by GCKPP_COMODE_MOD
! 


MODULE gckpp_Rates

  USE gckpp_Parameters
  USE gckpp_Global
  IMPLICIT NONE

CONTAINS

!phs
!phs
!phs! Begin Rate Law Functions from KPP_HOME/util/UserRateLaws
!phs
!phs!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs!  User-defined Rate Law functions
!phs!  Note: the default argument type for rate laws, as read from the equations file, is single precision
!phs!        but all the internal calculations are performed in double precision
!phs!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs
!phs!~~~>  Arrhenius
!phs   REAL(kind=dp) FUNCTION ARR( A0,B0,C0 )
!phs      REAL A0,B0,C0      
!phs      ARR =  DBLE(A0) * EXP(-DBLE(B0)/TEMP) * (TEMP/300.0_dp)**DBLE(C0)
!phs   END FUNCTION ARR        
!phs
!phs!~~~> Simplified Arrhenius, with two arguments
!phs!~~~> Note: The argument B0 has a changed sign when compared to ARR
!phs   REAL(kind=dp) FUNCTION ARR2( A0,B0 )
!phs      REAL A0,B0           
!phs      ARR2 =  DBLE(A0) * EXP( DBLE(B0)/TEMP )              
!phs   END FUNCTION ARR2          
!phs
!phs   REAL(kind=dp) FUNCTION EP2(A0,C0,A2,C2,A3,C3)
!phs      REAL A0,C0,A2,C2,A3,C3
!phs      REAL(kind=dp) K0,K2,K3            
!phs      K0 = DBLE(A0) * EXP(-DBLE(C0)/TEMP)
!phs      K2 = DBLE(A2) * EXP(-DBLE(C2)/TEMP)
!phs      K3 = DBLE(A3) * EXP(-DBLE(C3)/TEMP)
!phs      K3 = K3*CFACTOR*1.0E6_dp
!phs      EP2 = K0 + K3/(1.0_dp+K3/K2 )
!phs   END FUNCTION EP2
!phs
!phs   REAL(kind=dp) FUNCTION EP3(A1,C1,A2,C2) 
!phs      REAL A1, C1, A2, C2
!phs      REAL(kind=dp) K1, K2      
!phs      K1 = DBLE(A1) * EXP(-DBLE(C1)/TEMP)
!phs      K2 = DBLE(A2) * EXP(-DBLE(C2)/TEMP)
!phs      EP3 = K1 + K2*(1.0E6_dp*CFACTOR)
!phs   END FUNCTION EP3 
!phs
!phs   REAL(kind=dp) FUNCTION FALL ( A0,B0,C0,A1,B1,C1,CF)
!phs      REAL A0,B0,C0,A1,B1,C1,CF
!phs      REAL(kind=dp) K0, K1     
!phs      K0 = DBLE(A0) * EXP(-DBLE(B0)/TEMP)* (TEMP/300.0_dp)**DBLE(C0)
!phs      K1 = DBLE(A1) * EXP(-DBLE(B1)/TEMP)* (TEMP/300.0_dp)**DBLE(C1)
!phs      K0 = K0*CFACTOR*1.0E6_dp
!phs      K1 = K0/K1
!phs      FALL = (K0/(1.0_dp+K1))*   &
!phs           DBLE(CF)**(1.0_dp/(1.0_dp+(LOG10(K1))**2))
!phs   END FUNCTION FALL
!phs
!phs  !---------------------------------------------------------------------------
!phs
!phs  ELEMENTAL REAL(kind=dp) FUNCTION k_3rd(temp,cair,k0_300K,n,kinf_300K,m,fc)
!phs
!phs    INTRINSIC LOG10
!phs
!phs    REAL(kind=dp), INTENT(IN) :: temp      ! temperature [K]
!phs    REAL(kind=dp), INTENT(IN) :: cair      ! air concentration [molecules/cm3]
!phs    REAL, INTENT(IN) :: k0_300K   ! low pressure limit at 300 K
!phs    REAL, INTENT(IN) :: n         ! exponent for low pressure limit
!phs    REAL, INTENT(IN) :: kinf_300K ! high pressure limit at 300 K
!phs    REAL, INTENT(IN) :: m         ! exponent for high pressure limit
!phs    REAL, INTENT(IN) :: fc        ! broadening factor (usually fc=0.6)
!phs    REAL(kind=dp) :: zt_help, k0_T, kinf_T, k_ratio
!phs
!phs    zt_help = 300._dp/temp
!phs    k0_T    = k0_300K   * zt_help**(n) * cair ! k_0   at current T
!phs    kinf_T  = kinf_300K * zt_help**(m)        ! k_inf at current T
!phs    k_ratio = k0_T/kinf_T
!phs    k_3rd   = k0_T/(1._dp+k_ratio)*fc**(1._dp/(1._dp+LOG10(k_ratio)**2))
!phs
!phs  END FUNCTION k_3rd
!phs
!phs  !---------------------------------------------------------------------------
!phs
!phs  ELEMENTAL REAL(kind=dp) FUNCTION k_arr (k_298,tdep,temp)
!phs    ! Arrhenius function
!phs
!phs    REAL,     INTENT(IN) :: k_298 ! k at T = 298.15K
!phs    REAL,     INTENT(IN) :: tdep  ! temperature dependence
!phs    REAL(kind=dp), INTENT(IN) :: temp  ! temperature
!phs
!phs    INTRINSIC EXP
!phs
!phs    k_arr = k_298 * EXP(tdep*(1._dp/temp-3.3540E-3_dp)) ! 1/298.15=3.3540e-3
!phs
!phs  END FUNCTION k_arr
!phs
!phs!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs!  End of User-defined Rate Law functions
!phs!~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs
!phs! End Rate Law Functions from KPP_HOME/util/UserRateLaws
!phs
!phs
!phs! Begin INLINED Rate Law Functions
!phs
!phs
!phs! End INLINED Rate Law Functions
!phs
!phs! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs! 
!phs! Update_SUN - update SUN light using TIME
!phs!   Arguments :
!phs! 
!phs! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
!phs
!phs  SUBROUTINE Update_SUN()
!phs      !USE gckpp_Parameters
!phs      !USE gckpp_Global
!phs
!phs    IMPLICIT NONE
!phs
!phs    REAL(kind=dp) :: SunRise, SunSet
!phs    REAL(kind=dp) :: Thour, Tlocal, Ttmp 
!phs    ! PI - Value of pi
!phs    REAL(kind=dp), PARAMETER :: PI = 3.14159265358979d0
!phs    
!phs    SunRise = 4.5_dp 
!phs    SunSet  = 19.5_dp 
!phs    Thour = TIME/3600.0_dp 
!phs    Tlocal = Thour - (INT(Thour)/24)*24
!phs
!phs    IF ((Tlocal>=SunRise).AND.(Tlocal<=SunSet)) THEN
!phs       Ttmp = (2.0*Tlocal-SunRise-SunSet)/(SunSet-SunRise)
!phs       IF (Ttmp.GT.0) THEN
!phs          Ttmp =  Ttmp*Ttmp
!phs       ELSE
!phs          Ttmp = -Ttmp*Ttmp
!phs       END IF
!phs       SUN = ( 1.0_dp + COS(PI*Ttmp) )/2.0_dp 
!phs    ELSE
!phs       SUN = 0.0_dp 
!phs    END IF
!phs
!phs END SUBROUTINE Update_SUN
!phs
!phs! End of Update_SUN function
!phs! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Update_RCONST - function to update rate constants
!   Arguments :
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SUBROUTINE Update_RCONST ( )


  USE gckpp_COMODE_MOD,        ONLY : R_KPP
  USE gckpp_Monitor

! Begin INLINED RCONST


! End INLINED RCONST

  INTEGER :: N

  DO N = 1, NREACT
    RCONST(N) = R_KPP(JLOOP,IND(N))
  END DO
      
END SUBROUTINE Update_RCONST

! End of Update_RCONST function
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~


! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
! 
! Update_PHOTO - function to update photolytical rate constants
!   Arguments :
! 
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

SUBROUTINE Update_PHOTO ( )


   USE gckpp_Global

      
END SUBROUTINE Update_PHOTO

! End of Update_PHOTO function
! ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~



END MODULE gckpp_Rates

