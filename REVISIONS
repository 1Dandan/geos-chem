REVISIONS (v8-02-04)
20 Jan 2010
Bob Yantosca, Claire Carouge, and Philippe Le Sager
geos-chem-support@as.harvard.edu


New in v8-02-04:
===============================================================================

In the GeosCore subdirectory:
-----------------------------

linoz_mod.f		-- Module containing routines for the Linoz
	 		   stratospheric chemistry algorithm

megan_mod.f             -- Module completely rewritten.

nei2005_anthro_mod.f    -- read, allocate, total, and deallocate NEI
		       	   2005 emissions data 

sulfate_pbl_mix	        -- does the PBL mixing of a column of sulfate
(sulfate_mod.f)		   emissions  


In the GeosUtil subdirectory:
-----------------------------

bpch_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

charpak_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

directory_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

error_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

file_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

grid_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

ifort_errmsg.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

julday_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

pressure_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers

regrid_1x1_mod.f	-- Moved here from GeosCore

time_mod.f		-- Moved here from GeosCore

transfer_mod.f		-- Moved here from GeosCore

unix_cmds_mod.f		-- Moved here from GeosCore
			-- Added ProTeX documentation headers


In the GeosCore subdirectory:
-----------------------------

readisolai_avhrr        -- READISOLAI subroutine renamed to distinguish
("lai_mod.f")              from READISOLAI_MODIS

readisolai_modis        -- Read MODIS LAI
("lai_mod.f")              

meganut_mod.f           -- New module for subroutine xltmmp, xlpardr 
			    and xlpardf


Removed in v8-02-04:
===============================================================================

Kr85_mod.f 		-- Moved to the "obsolete" folder for later reference

xltmmp.f                -- Subroutine added to module "meganut_mod.f".
			-- File moved to "obsolete" folder for later reference

readisolai              -- Renamed to READISOLAI_AVHRR to distinguish
("lai_mod.f")              from READISOLAI_MODIS



Modified in v8-02-04:
===============================================================================

Makefile_header.mk	-- Minor fix, add -m64 if SUN32 is not defined


Input files for GEOS-Chem:
--------------------------

ratj.d     		-- Updated the branching ratio of HNO4.  
			   Changed the lines:
			      Line 13 HNO4 from 33.3 to 5.0
			      Line 14 HNO4 from 66.7 to 95.0
			   This is based on Jimenez et al, "Quantum yields 
			   of OH, HO2 and NO3 in the UV photolysis of HO2NO2" 
			   (jmao, bmy, 10/27/09)

input.geos		-- has an additional lines for EPA2005, LINOZ, PCEEA,
			   MODIS-LAI

jv_spec.dat             -- Correct line 25: "HCHO=H+293 ..."


In the Headers subdirectory:
----------------------------

define.h		-- Removed references to IN_CLOUD_OD
			-- Added ProTeX headers

CMN_DIAG                -- Increase PD46 to 13

CMN_O3                  -- Add EMISS_BVOC in new common bloc EMISS100

CMN_SIZE        	-- set NOXLEVELS and NOXEXTENT to 5



In the GeosCore subdirectory:
-----------------------------

accumulate_diag51       -- Add outputs for EMISS_BVOC (10 tracers), TS, 
("diag51_mod.f")            PARDR, PARDF and ISOLAI

anthroems.f	        -- account for NOXLEVELS not equal to 2

arsl1k.f		-- Prevent div-by-zero errors by returning the
			   default value if any of the arguments are zero 
			-- Added ProTeX Header

biogenic_oc             -- update MEGAN calculation to v2.1
("carbon_mod.f")

calcrate.f		-- FastJX has taken near-IR photolysis into account 
                           with cross section at 574nm, so we don't need to 
	                   manually add 1e-5 to the JHNO4 rate anymore.


chem_dms		-- Update reaction rate to match JPL06 and full chem
("sulfate_mod.f")

chem_so2		-- Update reaction rate to match JPL06 and full chem
("sulfate_mod.f")

chem_tagged_ox		-- Now only compute loss rate in troposphere 
("tagged_ox_mod.f")

cleanup.f		-- Now references CLEANUP_LINOZ

cleanup_diag51          -- Deallocate GOOD_EMIS and GOOD_CT_EMIS
("diag51_mod.f")

cleanup_sulfate		-- Deleted obsolete arrays from older SO2 volcanic
("sulfate_mod.f")          emissions inventory

compute_biomass_emissions -- Irrespective of inventory type, we need to 
("biomass_mod.f")            scale biomass CO to account for CO production
                             from VOC's that are not explicitly carried in the 
                             chemistry mechanisms. This used to be done in 
                             gc_biomass_mod.f but then is not used for GFED2, 
                             FLAMBE, etc.

diag20			-- Bug fix: Now just zero arrays w/o loop indices
("diag_pl_mod.f")

diag3.f                 -- accounts for 3D AD13_NH3_an

diag49                  -- Add outputs for EMISS_BVOC (10 tracers), TS, 
("diag49_mod.f")            PARDR, PARDF and ISOLAI

diag51_mod.f            -- Add module variables GOOD_EMIS and GOOD_CT_EMIS
                            to manage emission outputs

diag_mod.f		-- AD13_NH3_an is declared as 3D
     
do_emissions    	-- account for NEI 2005
(emissions_mod.f)

dst_mbl			-- new scale factor for dust mobilization for 
("dust_dead_mod.f")        GEOS5 at 2x2.5

emisssulfate		-- Now read new volcanic SO2 emissions daily
("sulfate_mod.f")

emfossil.f		-- account for NEI 2005

emissdr.f               -- Update for MEGAN v2.1

fast_j.f 		-- Removed references to IN_CLOUD_OD		

findmon.f               -- Add year management (needed for MODIS-LAI)

get_alk			-- Updated hygroscopic growth factors according to
("seasalt_mod.f")          recommendations from Becky Alexander

init_diag51             -- Allocate GOOD_EMIS and GOOD_CT_EMIS
("diag51_mod.f")

init_drydep		-- Minor bug fix: ALPH, LIMO should have 
("drydep_mod.f")           molwt = 136.23, not 136 even

init_input		-- Now initialize LLINOZ
("input_mod.f")         -- Now initialize LMODILAI and LPCEEA
			-- Now initialize LNEI05

init_sulfate		-- Now redimension EEV & NEV arrays for new SO2 
("sulfate_mod.f")          volcanic emissions inventory
			-- Deleted obsolete arrays from older SO2 volcanic
                           emissions inventory

init_tracerinfo		-- Previous bug for molecular weight of ALD2 had 
("gamap_mod.f")		   been applied to PRPE.  Now corrected, ALD2 has
	 		   2 carbons and PRPE has 3 carbons.
			-- NTRAC for ND46 increased from 6 to 13.
                           Add definition of new tracers
			-- NTRAC for time series increased from 26 to 32
			   Add definition of new tracers

logical_mod.f		-- added LNEI05
		        -- added LLINOZ
			-- added LMODISLAI
			-- added LPECCA
     
main.f			-- Now calls LINOZ_READ at startup
			-- Add the year in call to RDLAI and RDISOLAI

Makefile		-- added nei2005_anthro_mod.o

ndxx_setup.f		-- Now AD13_SO2_an and AD13_SO4_an have NOXLEVELS
			   levels to accomodate NEI 2005
			-- accounts for 3D AD13_NH3_an
                        -- MASSFLEW, MASSFLNS and MASSFLUP are scalar if 
                           the diagnostics are not used.

open_a6_fields		-- Removed references to IN_CLOUD_OD
("a6_read_mod.f")

readlai.f               -- Read files for MODIS-LAI. Add year as argument.

rdisolai                -- Add YEAR for MODIS
("lai_mod.f")           -- Add call to MODIS-LAI for global simulations only

rdlai.f                 -- Add the year for MODIS

read_a3			-- Removed references to IN_CLOUD_OD
("a3_read_mod.f")

read_a6			-- Removed references to IN_CLOUD_OD
("a6_read_mod.f")

read_i6			-- Removed references to IN_CLOUD_OD
("i6_read_mod.f")

read_anthro_sox		-- account for multilevels emissions
("sulfate_mod.f")
     
read_emissions_menu	-- Bug fix: for now, if LEMEPSHIP is turned on but 
("input_mod.f")            LEMEP is turned off, just turn off LEMEPSHIP and 
                           print a warning msg
			-- Now reads for LNEI05
			-- Now reads for LMODISLAI
                           Add check on LAI switches.
			-- Now reads for LPECCA (PCEEA model)

read_erup_volc		-- Complete re-write as volcanic emissions are now 
("sulfate_mod.f")          monthly and stored as BPCH files

read_nd49_menu          -- Increase # of tracers from 100 to 120
("input_mod.f")

read_nonerup_volc	-- Complete re-write as volcanic emissions are now 
("sulfate_mod.f")          monthly and stored as BPCH files

read_simulation_menu	-- Now read LLINOZ switch from input.geos file
("input_mod.f")

setemis.f		-- anthro NOx emissions above PBL are left
                           in their initial level 

srcso2			-- account for NEI 2005 
("sulfate_mod.f")	-- Rewrite Aerocom SO2 emissions section to avoid 
                           errors on SunStudio compiler.  Also avoid div by 0.

srcso4			-- account for NEI 2005
("sulfate_mod.f")

srcnh3			-- account for NEI 2005; multilevel emiss. now
("sulfate_mod.f")

srcsalt			-- The source function is for wet aerosol radius 
("seasalt_mod.f")          (RH=80%, with a radius twice the size of dry 
                           aerosols) so BETHA should be set to 2 instead of 1
			-- Also now use LOG10 instead of LOG in the expressions
			   for the seasalt base source, since we need the 
			   logarithm to the base 10.

sulfate_mod.f		-- Removed obsolete arrays from old volcanic emissions
			-- Commented out LEEV and LENV flags

tagged_ox_mod.f		-- Various updates for Linoz

tpcore_fvdas            -- MASSFLEW, MASSFLNS and MASSFLUP declarations are 
("tpcore_fvdas_mod.f90")   changed.

upbdflx_mod.f		-- Various updates for Linoz

write_diag51            -- Add outputs for EMISS_BVOC (10 tracers), TS, 
("diag51_mod.f")            PARDR, PARDF and ISOLAI


Removed obsolete, commented out code from the following routines:
===============================================================================
calcrate.f
carbon_mod.f
diag3.f
diag42_mod.f
diag48_mod.f
diag49_mod.f
diag51_mod.f
emfossil.f
emissdr.f
error_mod.f
gamap_mod.f
gc_biomass_mod.f
geia_mod.f
global_ch4_mod.f
h2_hd_mod.f
input_mod.f
lightning_nox_mod.f
main.f
ocean_mercury_mod.f
planeflight_mod.f
regrid_1x1_mod.f
setemis.f
streets_anthro_mod.f
toms_mod.f
tpcore_geos5_window_mod.f90
tropopause_mod.f
tracerid_mod.f
upbdflx_mod.f
wetscav_mod.f


