REVISIONS (v8-02-05)
02 Feb 2010
Bob Yantosca and Claire Carouge
geos-chem-support@as.harvard.edu


New in v8-02-05:
===============================================================================


In the Headers subdirectory:
----------------------------

nothing


In the GeosUtil subdirectory:
-----------------------------

hdf_mod.f			-- Contains routines to write data to
				   HDF5 files.

is_safe_exp			-- Lets you test if an EXP(x) would result
("error_mod.f")			   in a floating-point exception

safe_exp			-- Allows you to return an alternate value
("error_mod.f")                    if an exponential would result in a
			 	   floating-point exception

safe_log			-- Allows you to return an alternate value
("error_mod.f") 		   if a natural logarithm would result in a
				   floating-point exception

safe_log10			-- Allows you to return an alternate value
("error_mod.f") 		   if a base-10 logarithm would result in a
				   floating-point exception


In the GeosCore subdirectory:
-----------------------------

diag51b_mod.f		    	-- Allows to save 2 satellite overpasses

emiss_emep_05x0666		-- Corresponding routine to EMISS_EMEP
("emep_mod.f")		           for 0.5 x 0.666 nested grids 

emiss_nei2005_anthro_05x0666	-- Corresponding routine to EMISS_NEI_ANTHRO
("nei2005_anthro_mod.f")           for 0.5 x 0.666 nested grids

get_nei99_season_05x0666	-- Corresponding routine to GET_NEI_SEASON
("nei2005_anthro_mod.f")           for 0.5 x 0.666 nested grids

get_vistas_season_05x0666	-- Corresponding routine to GET_VISTAS_SEASON
("nei2005_anthro_mod.f")           for 0.5 x 0.666 nested grids

get_nei99_wkscale_05x0666	-- Corresponding routine to GET_NEI_WKSCALE
("nei2005_anthro_mod.f")           for 0.5 x 0.666 nested grids

isoropiaII_mod.f		-- Contains the routines that provide the 
				   interface between ISORROPIA II and 
			           GEOS-Chem.  (The actual unmodified 
                                   ISORROPIA II code from Thanos Nenes which 
				   performs Na-SO4-NH3-NO3-Cl-(Ca-K-Mg) 
			           aerosol thermodynamic equilibrium is in 
			           ISOROPIA/isoropiaIIcode.f.)

read_canada_mask_05x0666        -- Corresponding routine to READ_CANADA_MASK
("cac_anthro_mod.f")	           for 0.5 x 0.666 nested grids 

read_europe_mask_05x0666        -- Corresponding routine to READ_EUROPE_MASK
("emep_anthro_mod.f")	           for 0.5 x 0.666 nested grids 

read_emep_updated_05x0666       -- Corresponding routine to READ_EMEP_UPDATED
("cac_anthro_mod.f")	           for 0.5 x 0.666 nested grids 

read_epa_05x0666		-- Corresponding routine to READ_EPA
("epa_nei_mod.f")	           for 0.5 x 0.666 nested grids

read_usa_mask_05x0666		-- Corresponding routine to READ_USA_MASK
("epa_nei_mod.f")	           for 0.5 x 0.666 nested grids


In the GeosTomas subdirectory:
------------------------------

Makefile			-- GEOS-Chem routines that have been 
aero_drydep.f		   	   modified to reference the TOMAS aerosol
carbon_mod.f			   microphysics package.  These are kept
chemdr.f			   in a separate GeosTomas directory so that
chemistry_mod.f			   they do not interfere with the routines
cleanup.f			   in the GeosCore directory.
diag3.f
diag_mod.f			   The GeosTomas directory only needs to
diag_pl_mod.f			   contain the files that have been modified
drydep_mod.f			   for TOMAS.  The Makefile will look for
dust_mod.f			   all other files from the GeosCore directory
emissions_mod.f			   using the VPATH option in GNU Make.
gamap_mod.f
initialize.f			   NOTE to GEOS-Chem developers: When you 
input_mod.f			   make changes to any of these routines 
isoropia_mod.f			   in the GeosCore directory, you must also
logical_mod.f 			   make the same modifications to the
ndxx_setup.f			   corresponding routines in the GeosTomas
planeflight_mod.f		   directory.
seasalt_mod.f
sulfate_mod.f			   Maybe in the near future we can work 
tomas_mod.f			   towards integrating TOMAS into the GeosCore
tomas_tpcore_mod.f90		   directory more cleanly.  However, due to 
tpcore_mod.f			   the large number of modifications that were
tpcore_window_mod.f		   necessary for TOMAS, it was quicker to 
tracerid_mod.f			   implement the TOMAS code in a separate
wetscav_mod.f			   subdirectory.  
xtra_read_mod.f				-- Bob Y. (1/25/10)


In the ISOROPIA subdirectory:
-----------------------------

isoropiaIIcode.f		-- Contains the unmodified ISORROPIA II code
				   from Thanos Nenes.  The interface between
				   this code and GEOS-Chem is provided in
				   GeosCore/isoropiaII_mod.f

isrpia.inc			-- Contains common-blocks and parameters
				   for the ISORROPIA II code


Removed in v8-02-05:
===============================================================================

isoropia_mod.f			-- Removed the obsolete ISORROPIA I code, which
				   is now replaced by ISORROPIA II.  Moved
				   to the obsolete/ subdirectory.


Modified in v8-02-05:
===============================================================================


Input files for GEOS-Chem:
--------------------------

input.geos			-- Added MICROPHYS MENU to select options
				   for TOMAS aerosol microphysics package
				-- Added switches for HDF5 output for
				   certain timeseries diagnostics (ND50,
				   ND51, ND51b)


GEOS-Chem Makefiles:
--------------------------

Makefile			-- Added Makefile targets for TOMAS aerosol
			           microphysics package

Makefile_header.mk		-- Rewritten to allow HDF5 diagnostic output 
				   option
				-- Now add -DTOMAS to FFLAGS if the variable
			           TOMAS=yes is passed

GeosCore/Makefile		-- Now get LINK from Makefile_header.mk
				-- Whem making "realclean", also call "clean" 
			           in the $(GEOSTOM)/Makefile.  Also make sure 
				   to remove executables in the $(BIN) dir

help/Makefile			-- Added info about TOMAS option


In the Headers subdirectory:
----------------------------

CMN_DIAG			-- Redimension PD59, PD60, PD61 for TOMAS
				-- Added LD59, LD60, LD61 to common block  
				-- Reset MAX_TRACER to NNPAR+1 for TOMAS
				   (within an #if defined( TOMAS ) block)

CMN_SIZE			-- Added ProTeX Headers
				-- Added parameters for NESTED_EU grid
				-- Set NNPAR=320 for TOMAS simulations
				-- Define TOMASBIN and TOMASSPEC for TOMAS sims

commsoil.h			-- Added # of land boxes for NESTED_EU grid

define.h			-- Added NESTED_EU switch


In the GeosUtil subdirectory:
-----------------------------

directory_mod.f			-- Created separate directory definitions 
				   TPBC_DIR_NA, TPBC_DIR_EU, TPBC_DIR_CH for 
				   multiple boundary condition outputs

read_bpch2			-- Add NESTED_EU flag
("bpch2_mod.f")


In the GeosCore subdirectory:
-----------------------------

accumulate_diag50q		-- Output AOD at 3rd jv_spec.dat row wavelength
("diag50_mod.f")		-- include all seven dust bin's individual AOD

accumulate_diag51		-- Output AOD at 3rd jv_spec.dat row wavelength
("diag51_mod.f")		-- include all seven dust bin's individual AOD

anthroems.f			-- GET_ANNUAL_SCALAR_05x0666_NESTED_CH renamed 
				   to GET_ANNUAL_SCALAR_05x0666_NESTED

avgpole				-- Also need to RETURN for 0.5 x 0.666 nested 
("dao_mod.f")           	   grid simulations

chemistry_mod.f			-- Added ProTeX documentation headers

chem_so2			-- Now prevent floating-point exceptions when 
("sulfate_mod.f") 	           taking the exponential terms.

cleanup.f			-- Now references CLEANUP_HDF from "hdf_mod.f"

close_files			-- Now close files IU_BC_NA, IU_BC_EU, IU_BC_CH
("file_mod.f")

do_emissions			-- Added emissions for nested grids 
("emissions_mod.f")		   @ 0.5 x 0.666 

do_the_regridding_05x0666_2d    -- Updated nested grid limits for EU & NA grids
("regrid_1x1_mod.f")

do_the_regridding_05x0666_3d    -- Updated nested grid limits for EU & NA grids
("regrid_1x1_mod.f")

dust_mbl		 	-- Defined FLX_MSS_FDG_FCT for GEOS_4 2x2.5, 
("dust_dead_mod.f")      	   GEOS_5 2x2.5, NESTED_NA and NESTED_EU
				-- Redefined FLX_MSS_FDG_FCT for NESTED_CH, 
				   based upon above changes

emep_mod.f			-- Maximum scale factor year is now 2007
				-- Extend 1x1 emission files to 2007.
				-- Routine READ_EMEP_UPDATED now mimics routine
                        	   READ_EMEP_UPDATED_05x0666.

emiss_cac_anthro		-- Use 2005 scale factors for years beyond 2005
("cac_anthro_mod.f")

emiss_epa_nei			-- Now can read 0.5 x 0.667 nested grid 
("epa_nei_mod.f")		   emissions 

emiss_streets_anthro		-- Now backscale from 2006 (to maximum of 2000)
("streets_anthro_mod.f") 	   rather than forward scale 2000 (to maximum 
			           of 2005)
				-- Addresses irregularity in 2005 to 2006 
				   emission output, but new irregularity likely
				   now occurs at 2000 to 2001 (although this is
				   likely less relevant to current studies)

emiss_streets_anthro_05x0666    -- Initiated 1/2x2/3 annual scaling
("streets_anthro_mod.f")

emithigh			-- Bug fix: EMIS_SAVE should be 
("carbon_mod.f")		   EMIS_SAVE(I,J,...) instead of 
				   EMIS_SAVE(:,:,...) since we are in a 
                           	   parallel loop

file_mod.f			-- Added file units IU_BC_NA,IU_BC_EU,IU_BC_CH 

gamap_mod.f			-- Include second satellite overpass diagnostic
				-- Adjust AOD name to 550 nm from 400 nm
				-- Add additional dust AOD bins
				-- Output values to hdf_mod

gckpp_driver			-- Now call GCKPP_DRIVER from physproc.f to 
("chemistry_mod.f")                save memory. 
                        	-- Now use the # of active species from GC to 
                           	   update CSPEC and not the of variable species
				   from KPP.

get_otd_lis_scale		-- Modification for GEOS-4 1 x 1.25 grid
("lightning_nox_mod.f")

geos4_geos5_global_adv  	-- Moved 'CALL SAVE_GLOBAL_TPCORE_BC' to main.f
("transport_mod.f")

get_annual_scalar_1x1   	-- Updated scale factors through 2006, changed
("scale_anthro_mod.f")	           to new directory, reset year limits
				-- Reformated scale factors to a single file 
				   for all years, made necessary input changes

init_carbon			-- Now set parameters for NESTED_EU grid
("carbon_mod.f")

input_mod.f			-- Created READ_ND51b_MENU routine to read the
                        	   ND51b menu (based on READ_ND51 routine)

lnd_frc_mbl_get			-- Modification for GEOS-4 1 x 1.25 grids
("dust_dead_mod.f")

logical_mod.f			-- Added 2x2.5 boundary conidition logical
				-- Added NESTED_NA, NESTED_EU, NESTED_CH, and 
			           NESTED_CU logicals
				-- Added hdf5 logicals

main.f				-- Added diag51b (satellite overpass copy)
				-- Moved TPCORE boundary coniditon output 
				   to main.f
				-- Now reference LWINDO from "logical_mod.f"

megan_mod.f			-- Added ProTeX documentation headers

meganut_mod.f			-- Updated comments

ocean_mercury_flux		-- Modifications for GEOS-4 1 x 1.25 grid
("ocean_mercury_mod.f")

ocean_source_acet		-- Additional scale factors for NESTED_NA and 
("acetone_mod.f")                  NESTED_EU calculated and includ
				-- Added scale factor for GEOS-4 1 x 1.25 grid

read_emep_updated		-- Add multi-species seasonality
("emep_mod.f")

physproc.f			-- Remove obsolete print statements & formats
			        -- Now call GCKPP_DRIVER with NSPEC(1), which 
				   is the # of active species for urban 
				   chemistry.

read_emissions_menu		-- Now force settings for EU, NA, CC 
				   nested grids
("input_mod.f")

read_nested_grid_menu		-- Now give user the option of saving out 
("input_mod.f")		   	   nested grid boundary conditions at 2 x 2.5 
				   resolution for the EU, CH, or NA grids 

read_input_file			-- Now call READ_ND51b_MENU
("input_mod.f")

read_nd50_menu			-- Now include option to save ND50 diagnostic
("input_mod.f")		   	   to HDF5 file format

read_nd51_menu			-- Now include option to save ND51 diagnostic
("input_mod.f")		           to HDF5 file format

read_todx             	        -- Modifications for reading data on GEOS-4 
("geia_mod.f")		   	   1 x 1.25 grids

regrid_05x0666_nested	        -- Updated nested grid parameters for 
("regrid_1x1_mod.f")		   EU & NA grids 

scale_anthro_mod.f		-- Renamed GET_ANNUAL_SCALAR_05x0666_NESTED_CH 
				   to GET_ANNUAL_SCALAR_05x0666_NESTED
				-- Rewrote GET_ANNUAL_SCALAR_05x0666_NESTED to 
		           	   retrieve and regrid scale factors by calling
				   GET_ANNUAL_SCALAR_1x1 and regridding on fly

soa_chemistry			-- Updated formulation of SOG condensation onto
("carbon_mod.f")		   OC aerosol, according to recommendations of 
				   Aerosol Working Group

tomsai				-- Modification for 1 x 1.25 grid
("gc_biomass_mod.f")

tpcore_bc_mod.f			-- Added 2x2.5 boundary condition output
			   	   (created GET_2x25_BC)
				-- Added multi-boundary condition output 
			   	   (NA, EU, CH and Custom region)
				-- Internally defined boundary condition 
				   regions for NA, EU and CH

validate_directories		-- Now check TPBC_DIR_NA, TPBC_DIR_CH, 
("input_mod.f")			   TPBC_DIR_EU

write_diag50			-- Now have the option of saving out to 
("diag51_mod.f")		   HDF5 format 

write_diag51			-- Now have the option of saving out to 
("diag51_mod.f")		   HDF5 format 

write_diag51b			-- Updated output for MEGAN species
("diag51b_mod.f")