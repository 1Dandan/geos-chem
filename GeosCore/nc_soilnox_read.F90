!------------------------------------------------------------------------------
!                  GEOS-Chem Global Chemical Transport Model                  !
!------------------------------------------------------------------------------
!BOP
!
! !IROUTINE: read_from_netcdf_file
!
! !DESCRIPTION: Routine to read variables and attributes from a netCDF
!  file.  This routine was automatically generated by the Perl script
!  NcdfUtilities/perl/ncCodeRead.
!\\
!\\
! !INTERFACE:
!
  SUBROUTINE READ_RESISTANCES( am_I_Root, Input_Opt, RC )
!
! !USES:
!
    ! Modules for netCDF read
    USE m_netcdf_io_open
    USE m_netcdf_io_get_dimlen
    USE m_netcdf_io_read
    USE m_netcdf_io_readattr
    USE m_netcdf_io_close

    ! GEOS-Chem modules
    USE COMMSOIL_MOD
    USE GIGC_ErrCode_Mod
    USE GIGC_Input_Opt_Mod, ONLY : OptInput

    IMPLICIT NONE

#   include "netcdf.inc"

!
! !INPUT PARAMETERS:
!
      LOGICAL,        INTENT(IN)  :: am_I_Root   ! Are we on the root CPU?
      TYPE(OptInput), INTENT(IN)  :: Input_Opt   ! Input Options object
!
! !OUTPUT PARAMETERS:
!
      INTEGER,        INTENT(OUT) :: RC          ! Success or failure?
!
!
! !REMARKS:
!  Generated with the ncCodeRead perl script from the NcdfUtilities package.
!  Subsequently hand-edited by Bob Yantosca.
!  Read resistances as function of MODIS/Koppen biome types to use in GET_CANOPY_NOX
!
! !REVISION HISTORY:
!  13 Jun 2012 - R. Yantosca - Initial version
!  24 Jun 2014 - R. Yantosca - Now accept am_I_Root, Input_Opt, RC

!EOP
!------------------------------------------------------------------------------
!BOC
!
! !LOCAL VARIABLES:
!
    !=================================================================
    ! Variable declarations
    !=================================================================

    ! Character strings
    CHARACTER(LEN=255) :: nc_dir             ! netCDF directory name
    CHARACTER(LEN=255) :: nc_file            ! netCDF file name
    CHARACTER(LEN=255) :: nc_path            ! netCDF path name
    CHARACTER(LEN=255) :: v_name             ! netCDF variable name 
    CHARACTER(LEN=255) :: a_name             ! netCDF attribute name
    CHARACTER(LEN=255) :: a_val              ! netCDF attribute value
    
    ! Variables for netCDF I/O
    INTEGER            :: fId                ! netCDF file ID
    INTEGER            :: st1d(1), ct1d(1)   ! For 1D arrays    

    !=================================================================
    ! Open and read data from the netCDF file
    !=================================================================

    ! Assume success
    RC        =  GIGC_SUCCESS

    ! Open file
    nc_file = 'soilNOx.Inputs_MODIS_Biomes.nc'  
    nc_dir  = TRIM( Input_Opt%DATA_DIR_1x1 ) // 'soil_NOx_201208/'
    nc_path = TRIM( nc_dir                 ) // TRIM( nc_file )
    CALL Ncop_Rd( fId, TRIM(nc_path) )
    
    ! Echo info to stdout
    WRITE( 6, 100 ) REPEAT( '%', 79 )
    WRITE( 6, 110 ) TRIM(nc_file)
    WRITE( 6, 120 ) TRIM(nc_dir)

      !----------------------------------------
      ! VARIABLE: SNIMODIS
      !----------------------------------------

      ! Variable name
      v_name = "SNIMODIS"

      ! Read SNIMODIS from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIMODIS, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIMODIS:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIMODIS:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRI
      !----------------------------------------

      ! Variable name
      v_name = "SNIRI"

      ! Read SNIRI from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRI, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRI:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRI:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRLU
      !----------------------------------------

      ! Variable name
      v_name = "SNIRLU"

      ! Read SNIRLU from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRLU, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRLU:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRLU:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRAC
      !----------------------------------------

      ! Variable name
      v_name = "SNIRAC"

      ! Read SNIRAC from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRAC, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRAC:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRAC:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRGSS
      !----------------------------------------

      ! Variable name
      v_name = "SNIRGSS"

      ! Read SNIRGSS from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRGSS, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRGSS:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRGSS:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRGSO
      !----------------------------------------

      ! Variable name
      v_name = "SNIRGSO"

      ! Read SNIRGSO from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRGSO, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRGSO:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRGSO:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRCLS
      !----------------------------------------

      ! Variable name
      v_name = "SNIRCLS"

      ! Read SNIRCLS from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRCLS, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRCLS:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRCLS:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIRCLO
      !----------------------------------------

      ! Variable name
      v_name = "SNIRCLO"

      ! Read SNIRCLO from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIRCLO, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIRCLO:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIRCLO:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !----------------------------------------
      ! VARIABLE: SNIVSMAX
      !----------------------------------------

      ! Variable name
      v_name = "SNIVSMAX"

      ! Read SNIVSMAX from file
      st1d   = (/ 1 /)
      ct1d   = (/ 24 /)
      CALL NcRd( SNIVSMAX, fId, TRIM(v_name), st1d, ct1d )

      ! Read the SNIVSMAX:long_name attribute
      a_name = "long_name"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Read the SNIVSMAX:units attribute
      a_name = "units"
      CALL NcGet_Var_Attributes( fId,TRIM(v_name),TRIM(a_name),a_val )

      ! Echo info to stdout
      WRITE( 6, 130 ) TRIM(v_name), TRIM(a_val)

      !=================================================================
      ! Cleanup and quit
      !=================================================================

      ! Close netCDF file
      CALL NcCl( fId )

      ! Echo info to stdout
      WRITE( 6, 140 )
      WRITE( 6, 100 ) REPEAT( '%', 79 )

      ! FORMAT statements
 100  FORMAT( a                                              )
 110  FORMAT( '%% Opening file  : ',         a               )
 120  FORMAT( '%%  in directory : ',         a, / , '%%'     )
 130  FORMAT( '%% Successfully read ',       a, ' [', a, ']' )
 140  FORMAT( '%% Successfully closed file!'                 )

  END SUBROUTINE READ_RESISTANCES
!EOC

